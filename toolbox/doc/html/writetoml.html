<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>writetoml - TOML Toolbox</title>
    <style>
        body { font-family: Helvetica, Arial, sans-serif; margin: 20px; line-height: 1.6; }
        h1 { color: #0076A8; border-bottom: 2px solid #0076A8; padding-bottom: 10px; }
        h2 { color: #0076A8; margin-top: 30px; }
        h3 { color: #333; }
        code { background-color: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-family: Consolas, Monaco, monospace; }
        pre { background-color: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto; }
        pre code { background-color: transparent; padding: 0; }
        .syntax { background-color: #E7F3F8; padding: 15px; border-radius: 5px; margin: 20px 0; }
        .note { background-color: #FFF4E6; border-left: 4px solid #FF9800; padding: 10px 15px; margin: 20px 0; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
        th { background-color: #0076A8; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }
    </style>
</head>
<body>
    <h1>writetoml</h1>
    <p>Write MATLAB struct to TOML configuration file</p>

    <h2>Syntax</h2>
    <div class="syntax">
        <code>writetoml(filename, data)</code><br>
        <code>writetoml(filename, data, Name=Value)</code>
    </div>

    <h2>Description</h2>
    <p><code>writetoml(filename, data)</code> writes the MATLAB struct <code>data</code> to a TOML file specified by <code>filename</code>.</p>

    <p><code>writetoml(filename, data, Name=Value)</code> specifies additional options using name-value arguments.</p>

    <h2>Input Arguments</h2>
    <table>
        <tr>
            <th style="width: 150px;">Name</th>
            <th style="width: 120px;">Type</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>filename</code></td>
            <td>string</td>
            <td>Path to the output TOML file. Can be an absolute or relative path. The <code>.toml</code> extension is recommended but not required.</td>
        </tr>
        <tr>
            <td><code>data</code></td>
            <td>struct</td>
            <td>MATLAB struct to serialize to TOML format. Struct fields correspond to TOML keys.</td>
        </tr>
    </table>

    <h3>Name-Value Arguments</h3>
    <table>
        <tr>
            <th style="width: 150px;">Name</th>
            <th style="width: 120px;">Type</th>
            <th style="width: 100px;">Default</th>
            <th>Description</th>
        </tr>
        <tr>
            <td><code>OverWrite</code></td>
            <td>logical</td>
            <td><code>false</code></td>
            <td>Allow overwriting existing files. If <code>false</code>, an error is thrown if the file already exists. If <code>true</code>, the existing file is replaced.</td>
        </tr>
        <tr>
            <td><code>Metadata</code></td>
            <td>dictionary</td>
            <td><code>[]</code></td>
            <td>Metadata from <code>readtoml</code> containing key ordering information. When provided, keys are written in the same order as the original file for round-trip operations.</td>
        </tr>
    </table>

    <h2>Examples</h2>

    <h3>Write a Simple Configuration</h3>
    <pre><code>% Create configuration
config.app_name = "My App";
config.version = 1.0;
config.debug = false;

% Write to file
writetoml("config.toml", config);</code></pre>

    <h3>Write Nested Configuration</h3>
    <pre><code>% Create nested structure
config.database.server = "localhost";
config.database.port = 5432;
config.database.name = "mydb";

config.logging.level = "info";
config.logging.file = "/var/log/app.log";

% Write to file
writetoml("app_config.toml", config);</code></pre>

    <h3>Overwrite Existing File</h3>
    <pre><code>% First write
data.key = "value1";
writetoml("test.toml", data);

% Update data
data.key = "value2";

% This would error (file exists):
% writetoml("test.toml", data);

% Explicitly allow overwrite
writetoml("test.toml", data, "OverWrite", true);</code></pre>

    <h3>Round-Trip with Key Ordering</h3>
    <pre><code>% Read file with metadata
[original, meta] = readtoml("input.toml");

% Modify values
original.database.port = 3306;
original.version = 2.0;

% Write back preserving original key order
writetoml("output.toml", original, "Metadata", meta, "OverWrite", true);</code></pre>

    <h3>Write Arrays</h3>
    <pre><code>% Create data with arrays
config.ports = [8080, 8081, 8082];
config.features = ["auth", "logging", "metrics"];
config.enabled_flags = [true, false, true];

writetoml("arrays.toml", config);</code></pre>

    <h2>Type Conversions</h2>
    <table>
        <tr>
            <th>MATLAB Type</th>
            <th>TOML Output</th>
            <th>Notes</th>
        </tr>
        <tr>
            <td>string (scalar)</td>
            <td>String</td>
            <td>Written with double quotes and escaping</td>
        </tr>
        <tr>
            <td>double (integer value)</td>
            <td>Integer</td>
            <td>Written without decimal point if <code>value == floor(value)</code></td>
        </tr>
        <tr>
            <td>double (non-integer)</td>
            <td>Float</td>
            <td>Written with decimal representation</td>
        </tr>
        <tr>
            <td>logical</td>
            <td>Boolean</td>
            <td>Written as <code>true</code> or <code>false</code></td>
        </tr>
        <tr>
            <td>Array</td>
            <td>Array</td>
            <td>Written as <code>[elem1, elem2, ...]</code></td>
        </tr>
        <tr>
            <td>struct (nested)</td>
            <td>Table</td>
            <td>Written with <code>[table.path]</code> headers</td>
        </tr>
        <tr>
            <td>struct (single-level)</td>
            <td>Inline Table</td>
            <td>Can be written as <code>{key = value, ...}</code></td>
        </tr>
        <tr>
            <td>datetime</td>
            <td>Datetime</td>
            <td>ISO 8601 format</td>
        </tr>
    </table>

    <h2>File Protection</h2>
    <div class="note">
        <strong>Important:</strong> By default, <code>writetoml</code> will throw an error if the output file already exists. This prevents accidental data loss. Use <code>OverWrite=true</code> to explicitly allow overwriting files.
    </div>

    <h2>Limitations</h2>
    <ul>
        <li>Arrays must be homogeneous (all elements of the same type)</li>
        <li>Field names with special characters are automatically quoted in the output</li>
        <li>Very deeply nested structures may have performance implications</li>
    </ul>

    <h2>See Also</h2>
    <p><a href="readtoml.html">readtoml</a>, <a href="examples.html">Examples</a></p>
</body>
</html>
